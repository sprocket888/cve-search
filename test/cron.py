import os
import sys
import unittest

runPath = os.path.dirname(os.path.realpath(__file__))
sys.path.append(os.path.join(runPath, ".."))

from  sbin.cvecrontab import  *


class TestCronTabWhenFormt(unittest.TestCase):
    def test_checkWhenFormatTrue(self):
        sample = "12:01"
        self.assertTrue(checkTimeFormat(sample))

    def test_checkWhenFormatFalse(self):
        sample = "26:32"
        self.assertFalse(checkTimeFormat(sample))


class TestCronTabPaths(unittest.TestCase):
    def test_currentPath(self):
        print(getCurrentPath())
        self.assertIn("search", str(getCurrentPath()))

class TestCronTabCreate(unittest.TestCase):
    def test_a_createcrontabFail(self ):
        with self.assertRaises(SystemExit) as cm:
            createCrontab("13:45")
            self.assertEqual(cm.exception, exits['wrongtimeformat'])

    def test_b_cronCreateJob(self):
        self.assertTrue(createCrontab())


    def test_c_checkCronJobExists(self):
        comment = 'cve_search'
        self.assertTrue(checkCronJobExists(comment))
    def test_d_getCronTabStatus(self):
        self.assertTrue(getCronTabStatus())


class TestCronTabRemove(unittest.TestCase):
    def test_a_cronRemoveJob(self):
        self.assertTrue(removeCronTab())

    def test_b_cronjobNotExists(self):
        comment = "cve_search"
        self.assertFalse(checkCronJobExists(comment))

