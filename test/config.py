#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#
# Tests for functions
#
# Software is free software released under the "Modified BSD license"
#
# Copyright (c) 2015 	Pieter-Jan Moreels - dubravko.sever@gmail.com

# Imports


import os
import sys
import unittest


runPath = os.path.dirname(os.path.realpath(__file__))
sys.path.append(os.path.join(runPath, ".."))



import lib.Config as config





class TestConfigurationReaders(unittest.TestCase):
    configuration = config.Configuration()

    def setUp(self):
        os.environ['SEARCHCVE_MONGODB'] = 'testdb'
        os.environ['SEARCHCVE_MONGOHOST'] = 'localhost'
        os.environ['SEARCHCVE_MONGOPORT'] = '27017'
        os.environ['SEARCHCVE_CVESTARTYEAR'] = '2022'

    def test_MongoDB(self):
        dbname = 'testdb'
        self.assertEqual(self.configuration.getMongoDB(), dbname)

    def test_MongoHost(self):
        self.assertEqual(self.configuration.getMongoHost(), 'localhost')

    def test_MongoPort(self):
        self.assertEqual(self.configuration.getMongoPort(), '27017')


    def test_CVEStartYear(self):
        startyear = '2002'
        self.assertEqual(str((self.configuration.getCVEStartYear())), startyear)

